<div class="min-h-screen bg-gray-50 py-8">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">

        <!-- En-tête de la page -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200 mb-6">
            <div class="px-6 py-4 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900">
                            <i class="fas fa-briefcase mr-3 text-primary-600"></i>
                            Candidature - {{ job?.title || 'Poste' }}
                        </h1>
                        <p class="text-gray-600 mt-1">Remplissez le formulaire ci-dessous pour postuler</p>
                    </div>
                    <button (click)="close()" class="text-gray-400 hover:text-gray-600 transition-colors p-2">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Contenu principal -->
        <div class="bg-white rounded-lg shadow-sm border border-gray-200">
            <div class="p-6">
                <!-- Message d'erreur général -->
                @if (error()) {
                <div class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-exclamation-triangle text-red-500 mr-3"></i>
                        <p class="text-red-700 font-medium">{{ error() }}</p>
                    </div>
                </div>
                }

                <!-- Message de succès -->
                @if (isSuccess()) {
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-check-circle text-green-500 mr-3"></i>
                        <div>
                            <p class="text-green-700 font-medium">Candidature envoyée avec succès !</p>
                            <p class="text-green-600 text-sm mt-1">Nous vous contacterons dans les plus brefs délais.
                            </p>
                        </div>
                    </div>
                </div>
                }

                <!-- Formulaire -->
                <form [formGroup]="applicationForm" (ngSubmit)="onSubmit()" class="space-y-8">
                    <!-- Informations générales -->
                    <section>
                        <h3 class="font-heading text-lg font-bold text-gray-900 mb-6">Informations générales</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Nom *
                                </label>
                                <input type="text" formControlName="lastName"
                                    class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                    [class.border-red-500]="hasFieldError('lastName')"
                                    [class.border-gray-300]="!hasFieldError('lastName')">
                                @if (hasFieldError('lastName')) {
                                <p class="text-red-500 text-sm mt-1">{{ getFieldError('lastName') }}</p>
                                }
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Prénom *
                                </label>
                                <input type="text" formControlName="firstName"
                                    class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                    [class.border-red-500]="hasFieldError('firstName')"
                                    [class.border-gray-300]="!hasFieldError('firstName')">
                                @if (hasFieldError('firstName')) {
                                <p class="text-red-500 text-sm mt-1">{{ getFieldError('firstName') }}</p>
                                }
                            </div>
                            
                                <div class="md:col-span-2">
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Poste actuel *
                                    </label>
                                    <input type="text" formControlName="currentPosition"
                                        class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                        [class.border-red-500]="hasFieldError('currentPosition')"
                                        [class.border-gray-300]="!hasFieldError('currentPosition')">
                                    @if (hasFieldError('currentPosition')) {
                                    <p class="text-red-500 text-sm mt-1">{{ getFieldError('currentPosition') }}</p>
                                    }
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Email *
                                    </label>
                                    <input type="text" formControlName="address"
                                        class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                        [class.border-red-500]="hasFieldError('address')"
                                        [class.border-gray-300]="!hasFieldError('address')">
                                    @if (hasFieldError('address')) {
                                    <p class="text-red-500 text-sm mt-1">{{ getFieldError('address') }}</p>
                                    }
                                </div>
                                <div  class="md:col-span-2">
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Numéro de téléphone
                                    </label>
                                    <input type="text" formControlName="phone" placeholder="+229 99 99 99 99"
                                        class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"
                                        [class.border-red-500]="hasFieldError('phone')"
                                        [class.border-gray-300]="!hasFieldError('phone')">
                                    @if (hasFieldError('phone')) {
                                    <p class="text-red-500 text-sm mt-1">{{ getFieldError('phone') }}</p>
                                    }
                                </div>
                           

                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Code postal
                                </label>
                                <input type="text" formControlName="postalCode"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Ville
                                </label>
                                <input type="text" formControlName="city"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Pays
                                </label>
                                <input type="text" formControlName="country"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Photo de profil
                                </label>
                                <input type="file" (change)="onFileChange($event, 'profilePhoto')" accept="image/*"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-medium file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100">
                            </div>
                        </div>
                    </section>
                    <!-- Informations profil -->
                    <section>
                        <h3 class="font-heading text-lg font-bold text-gray-900 mb-6">Informations profil</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    CV *
                                </label>
                                <input type="file" (change)="onFileChange($event, 'cv')" accept=".pdf,.doc,.docx"
                                    class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-medium file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"
                                    [class.border-red-500]="hasFieldError('cv')"
                                    [class.border-gray-300]="!hasFieldError('cv')">
                                @if (hasFieldError('cv')) {
                                <p class="text-red-500 text-sm mt-1">{{ getFieldError('cv') }}</p>
                                }
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Site web
                                    </label>
                                    <input type="url" formControlName="website" placeholder="https://"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        LinkedIn
                                    </label>
                                    <input type="url" formControlName="linkedin" placeholder="https://linkedin.com/in/"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Facebook
                                    </label>
                                    <input type="url" formControlName="facebook" placeholder="https://facebook.com/"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                                <div>
                                    <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                        Twitter
                                    </label>
                                    <input type="url" formControlName="twitter" placeholder="https://twitter.com/"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Lettre de motivation -->
                    <section>
                        <h3 class="font-heading text-lg font-bold text-gray-900 mb-6">Lettre de motivation</h3>
                        <textarea formControlName="coverLetter" rows="6"
                            placeholder="Expliquez-nous pourquoi vous souhaitez rejoindre Label Conseils..."
                            class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"
                            [class.border-red-500]="hasFieldError('coverLetter')"
                            [class.border-gray-300]="!hasFieldError('coverLetter')"></textarea>
                        @if (hasFieldError('coverLetter')) {
                        <p class="text-red-500 text-sm mt-1">{{ getFieldError('coverLetter') }}</p>
                        }
                    </section>
                    <!-- Quelques questions -->
                    <section>
                        <h3 class="font-heading text-lg font-bold text-gray-900 mb-6">Quelques questions...</h3>
                        <div class="space-y-4">
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Qu'est-ce qui vous motive dans ce poste ?
                                </label>
                                <textarea formControlName="motivation" rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none"></textarea>
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Quelle est votre disponibilité ?
                                </label>
                                <input type="text" formControlName="availability"
                                    placeholder="Ex: Immédiate, 2 mois de préavis..."
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block font-body text-sm font-medium text-gray-700 mb-2">
                                    Prétentions salariales
                                </label>
                                <input type="text" formControlName="salary" placeholder="Ex: À négocier, 45-55k..."
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent">
                            </div>
                        </div>
                    </section>
                    <!-- Consentement -->
                    <section>
                        <label class="flex items-start space-x-3">
                            <input type="checkbox" formControlName="dataConsent"
                                class="w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500 mt-1"
                                [class.border-red-500]="hasFieldError('dataConsent')">
                            <span class="font-reading text-sm text-gray-700 leading-relaxed">
                                J'accepte que mes données soient traitées par Label Conseils pour le compte du recruteur
                                dans le
                                cadre de ma candidature.
                            </span>
                        </label>
                        @if (hasFieldError('dataConsent')) {
                        <p class="text-red-500 text-sm mt-2 ml-7">{{ getFieldError('dataConsent') }}</p>
                        }
                    </section>
                    <!-- Actions -->
                    <div class="flex justify-between items-center pt-8 border-t border-gray-200">
                        <button type="button" (click)="close()"
                            class="px-6 py-3 border border-gray-300 text-gray-700 font-medium rounded-lg hover:bg-gray-50 transition-colors duration-300">
                            <i class="fas fa-arrow-left mr-2"></i>
                            Retour
                        </button>
                        <button type="submit" [disabled]="isSubmitting() || !applicationForm.valid"
                            class="px-8 py-3 bg-primary-600 text-white font-medium rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-300">
                            @if (!isSubmitting()) {
                            <span>
                                <i class="fas fa-paper-plane mr-2"></i>
                                Envoyer ma candidature
                            </span>
                            }
                            @if (isSubmitting()) {
                            <span class="flex items-center">
                                <i class="fas fa-spinner fa-spin mr-2"></i>
                                Envoi en cours...
                            </span>
                            }
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>